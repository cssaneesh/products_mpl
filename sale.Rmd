---
output:
  pdf_document: default
  html_document: default
---

*SALES REPORT*  

# Sales & Procurment Report of Sri Vijayasree  

### Prepared by Sanesh  
### Date:
```{r echo=FALSE, message=FALSE}
Sys.Date()
```
```{r echo=FALSE, message=FALSE}
library(tidyverse)
library(readxl)
library(janitor)
library(gt)

sale <- read_excel("mar8.xlsx", # COPY THE NAME OF THE FILE AND REPLACE sale1
                   sheet = "data-products", 
    col_types = c("text", "text", "text", 
        "text", "text", "text", "numeric", 
        "numeric", "text", "text"))
sale1 <- janitor::clean_names(sale)
```
### Sale  
```{r  echo=FALSE, message=FALSE}
todayssale <- sale1 %>% mutate(Sr.No = row_number()) %>% 
  mutate(Product= data_products_product,
                               Category=data_products_category, 
                               Detail= data_products_details,
                               Boxes= data_products_boxes,
                               Box_detail=data_products_boxes_detail) %>%  
  group_by(Sr.No, Product,Category, Detail) %>% summarise(Sale=sum(Box_detail), .groups = 'drop')
todayssale %>%  gt()
```
### Stock  

```{r echo=FALSE, message=FALSE}
stock <- read_excel("stock8.xlsx", sheet = "data-products")
stock1 <- janitor::clean_names(stock)
```

```{r  echo=FALSE, message=FALSE}
todaysstock <- stock1 %>% mutate(Sr.No = row_number()) %>% 
  mutate(Product= data_products_product,
                               Category=data_products_category, 
                               Detail= data_products_details,
                               Boxes= data_products_boxes,
                               Box_detail=data_products_boxes_detail) %>%  
  group_by(Sr.No, Product,Category, Detail) %>% summarise(Procurment=sum(Box_detail), .groups = 'drop')
todaysstock %>%  gt()
```
# Sale vs Stock
```{r echo=FALSE, message=FALSE}
saleStock <- full_join(x = todaysstock, y = todayssale) %>% 
  group_by(Product,Category, Detail,Procurment, Sale ) %>% 
  mutate(Sr.No = row_number()) %>% summarise(Final_stock= Procurment-Sale)


left_join  (x = todaysstock, y = todayssale) %>% 
  distinct(Product,Category, Detail, Procurment, Sale ) %>% 
  group_by(Product,Category, Detail,Procurment, Sale ) %>% 
  mutate(Sr.No = row_number()) %>% summarise(Final_stock= Procurment-Sale)
  

```



